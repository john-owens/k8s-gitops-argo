homer:
  image:
    repository: b4bz/homer
    tag: 21.09.2
  env:
    TZ: "America/Chicago"
  service:
    main:
      port:
        port: 8080
  ingress:
    main:
      enabled: true
      annotations:
        kubernetes.io/ingress.class: nginx
        cert-manager.io/cluster-issuer: vault-issuer
        cert-manager.io/common-name: home.rsr.net
      hosts:
        - host: home.rsr.net
          paths:
            - path: /
              pathType: Prefix
      tls:
        - hosts:
            - home.rsr.net
          secretName: homer-cert-tls
  persistence:
    config:
      enabled: true
      storageClass: "longhorn"
      accessMode: ReadWriteOnce
      size: "1Gi"
      skipuninstall: true
  podAnnotations:
    backup.velero.io/backup-volumes: config
  addons:
    codeserver:
      enabled: true
      image:
        repository: codercom/code-server
        tag: 4.0.1
      workingDir: "/www/assets"
      args:
        - --user-data-dir
        - "/www/assets/.vscode"
        - --auth
        - "none"
      ingress:
        enabled: true
        annotations:
          kubernetes.io/ingress.class: nginx
          cert-manager.io/cluster-issuer: vault-issuer
          cert-manager.io/common-name: home-config.rsr.net
          nginx.ingress.kubernetes.io/auth-url: "https://auth.rsr.net/oauth2/auth"
          nginx.ingress.kubernetes.io/auth-signin: "https://auth.rsr.net/oauth2/start"
        hosts:
          - host: home-config.rsr.net
            paths:
              - path: /
                pathType: Prefix
        tls:
          - hosts:
              - home-config.rsr.net
            secretName: homer-config-cert-tls
      volumeMounts:
        - name: config
          mountPath: /www/assets
  resources:
    requests:
      memory: 250Mi
      cpu: 500m
    limits:
      memory: 1500Mi
      cpu: 2000m
